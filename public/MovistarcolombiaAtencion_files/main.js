try{(function(k,o,r,g){var h=k("[id$='userSettingsList']").data("val-regex");var l=function(){this.ele="#ucm";this.isValid=false};l.prototype.init=function(){this.$wraper=k(this.ele);if(!this.$wraper.length){return false}this.$modalToggleButton=k(".js-customization-modal-trigger");this.$modalTabs=k("#ucm__step-tabs");this.$modalCarousel=k(".js-user_customization_modal__slider");this.$noClientButton=k(".js-user_customization_no-client");this.$skipButton=k(".js-user_customization_skip");this.$backButton=k(".js-user_customization_back");this.$cancelButton=k(".js-user_customization_cancel");this.$clientPhoneButton=k("#user_phone_btn");this.$phoneInput=this.$wraper.find(".js-ucm__phone-input");this.$circleInput=this.$wraper.find(".js-circle-validator");this.$containerModal=k("#ucm");this.$overlayModal=k(".modal-overlay");this.$body=k("body");var t={$previousDot:null,$activeDot:null,time:0,isPause:false,tick:false,percentTime:0,$lickItem:this,self:this};var s=this;this.$modalCarousel.on("init beforeChange",function(v,u,x,w){if(v.type==="init"){t.$activeDot=u.$dots.find(".slick-active")}else{t.$previousDot=u.$dots.children().eq(x);t.$activeDot=u.$dots.children().eq(w)}if(u.options.autoplay){t.time=u.options.autoplaySpeed/1000;s._startProgressbar(t)}});this.$modalCarousel.slick({dots:true,arrows:false,mobileFirst:true,infinite:true,autoplay:true,accessibility:false,autoplaySpeed:6000,dotsClass:"progress-dots",customPaging:function(){return'<div class="progress-dots__item"><div class="progress-dots__progress"><div class="progress-dots__progress-inner"></div></div></div>'},responsive:[{breakpoint:600,settings:{arrows:true}}]});k("#ucm.modal .progress-dots").wrap("<div class='hero__dots'></div>");this._initEvents()};l.prototype.onClose=function(s){this.$onCloseCallBack=s};l.prototype._initEvents=function(){this.$noClientButton.on("click",{self:this},this._noClientAction);this.$skipButton.on("click",{self:this},this._skipAction);this.$backButton.on("click",{self:this},this._backAction);this.$cancelButton.on("click",{self:this},this._cancelAction);this.$phoneInput.on("change keyup blur",{self:this},this._inputValidation);this.$phoneInput.on("keydown",this._numberOnly);this.$clientPhoneButton.on("click",{self:this},this._inputAdvance)};l.prototype._noClientAction=function(t){var s=t.data.self;t.preventDefault();s.$modalTabs.tabs("select_tab","ucm__step-2")};l.prototype._skipAction=function(t){var s=t.data.self;t.preventDefault();s.$wraper.modal("close")};l.prototype._backAction=function(t){var s=t.data.self;s.$modalTabs.tabs("select_tab","ucm__step-1")};l.prototype._cancelAction=function(t){var s=t.data.self;t.preventDefault();s.$wraper.modal("close");if(s.$onCloseCallBack){s.$onCloseCallBack()}};l.prototype._toggleModal=function(){if(typeof this.$wraper==="undefined"){this.$wraper=k(this.ele)}this.$wraper.modal({opacity:0.8,dismissible:false,endingTop:k(o).width()>600?"10%":"0%",ready:function(t,s){k(".js-user_customization_modal__slider").slick("setPosition")}}).modal("open")};l.prototype._inputValidation=function(u){var t=k(this),s=t.parent();if(t.val().length!==9){s.removeClass("valid").addClass("error");u.data.self.isValid=false}else{s.removeClass("error").addClass("valid");u.data.self.isValid=true}};l.prototype._numberOnly=function(s){if(k.inArray(s.keyCode,[46,8,9,27,13,110,190])!==-1||(s.keyCode==65&&s.ctrlKey===true)||(s.keyCode>=35&&s.keyCode<=39)){}else{if((s.shiftKey||(s.keyCode<48||s.keyCode>57))&&(s.keyCode<96||s.keyCode>105)){s.preventDefault()}}};l.prototype._inputAdvance=function(t){var s=t.data.self;if(s.isValid){s.$modalTabs.tabs("select_tab","ucm__step-2")}};l.prototype._startProgressbar=function(s){this._resetProgressbar(s);s.isPause=false;s.percentTime=0;s.tick=setInterval(this._interval,10,s)};l.prototype._resetProgressbar=function(s){if(s.$previousDot){s.$previousDot.find(".progress-dots__progress-inner").css({width:0+"%"});clearTimeout(s.tick)}};l.prototype._interval=function(s){if(s.isPause===false){s.percentTime+=1/(s.time+0.1);s.$activeDot.find(".progress-dots__progress-inner").css({width:s.percentTime+"%"});if(s.percentTime>=100){if(s.$lickItem.slick){s.$lickItem.slick("slickNext");s.self._startProgressbar(s)}else{}return false}}};l.prototype._noBlockingModal=function(t){var s=r.body.querySelector("#ucm");if(r.body.contains(s)){if(k(o).width()<993){this.$containerModal.removeClass("modal-desktop").addClass("modal-mobile");this.$body.removeAttr("style");this.$overlayModal.css("position","relative")}else{this.$containerModal.removeClass("modal-mobile").addClass("modal-desktop");this.$overlayModal.css("position","fixed")}}};l.prototype._changeModal=function(t){var s=r.body.querySelector("#ucm");if(r.body.contains(s)){if(k(o).width()<993){this.$containerModal.removeClass("modal-desktop").addClass("modal-mobile");this.$overlayModal.css("position","relative")}else{this.$containerModal.removeClass("modal-mobile").addClass("modal-desktop");this.$overlayModal.css("position","fixed")}}};k.PersonalizationModal=new l();k.PersonalizationModal.Constructor=l;k(o).resize(function(){k.PersonalizationModal._changeModal()});k(r).ready(function(){k.PersonalizationModal.init();k.PersonalizationModal._noBlockingModal()});var f="none";var q="client";var c="not-client";o.userSettingsPortlet_initModal=function(u,v,t){var s=new j(u,v,t);s.init();return s};o.userSettingsPortlet_initPage=function(t){var s=new b(t);s.init()};o.userSettingsPortlet_initMenu=function(t){var s=new p(t);s.init()};var d=function(t){this.portletNamespace=t;this.timeOutCookie="CANALONLINE_MODAL_TIMEOUT";this.timeToRefreshModal=15*24*60*60*1000;this.daysToExpire=90;this.noClientAttr="noClient";this.clientPhone=null;this.userSettingsList=k("#"+t+"userSettingsList");this.settingsCards=this.userSettingsList.find('.checkbox__panel input[type="checkbox"]');this.settingsCardsDiv=this.userSettingsList.find(".checkbox__panel");this.cookieSegmentsName=this.userSettingsList.data("cookie");this.cookieSegmentsSharedName=this.userSettingsList.data("shared-cookie");this.cookieUserProfileName=this.userSettingsList.data("profile-cookie");this.cookieUserPhoneName=this.userSettingsList.data("phone-cookie");var s=this.userSettingsList.data("ck-timeout");if(s){this.timeToRefreshModal=s*24*60*60*1000}this.submitform=k("#"+t+"submitform")};d.prototype.cardOnclick=function(t){var s=this;var v=k(t.target).closest(".checkbox__panel");s.settingsCards.each(function(w,x){k(x).prop("checked",false)});var u=v.find('input[type="checkbox"]');u.prop("checked",!u.prop("checked"))};d.prototype.submit=function(v){var u=this;var t=null;var w=null;u.settingsCards.each(function(x,z){var y=k(z);if(y.prop("checked")){t=y.data("segment");w=y.closest(".checkbox__panel").find(".checkbox__panel-title").text();return false}});if(t&&!u.submitting){u.submitting=true;if(k.GtmManager&&k.GtmManager.settingSelected){k.GtmManager.settingSelected(w,t)}var s={phone:u.clientPhone?u.clientPhone:g,segment:t,active:v,profile:u.clientPhone?q:c};m(u.cookieSegmentsName,JSON.stringify(s),u.daysToExpire);if(s.phone){m(u.cookieUserPhoneName,s.phone,u.daysToExpire)}m(u.timeOutCookie,(new Date()).getTime()+u.timeToRefreshModal,u.daysToExpire);if(v){m(u.cookieSegmentsSharedName,t,u.daysToExpire);m(u.cookieUserProfileName,u.clientPhone?q:c,u.daysToExpire)}else{m(u.cookieSegmentsSharedName,"",u.daysToExpire);m(u.cookieUserProfileName,f,u.daysToExpire)}u.submitform.submit()}};var j=function(t,u,s){this.base=d;this.base(t);this.isHome=u;this.clientPhoneInpt=k("#user_phone");this.clientPhoneButton=k("#user_phone_btn");this.clientPhoneInptWrapper=this.clientPhoneInpt.parent();this.notClient=k("#"+t+"notClient");this.enablePopup=s;this.submitting=false};j.prototype=new d();j.prototype.init=function(){this.checkUserCfg();this.bindEvents()};j.prototype.checkUserCfg=function(){var x=this;var v=parseInt(i(this.timeOutCookie));var w=(new Date()).getTime();if((isNaN(v)||(v-w)<0)&&x.enablePopup){var u=true;var t=i(this.cookieUserPhoneName);if(t){x.clientPhone=t;var s=i(this.cookieSegmentsSharedName);if(s&&isNaN(v)){u=false}else{x.clientPhoneInpt.val(t);x.refreshSelectedCards()}}if(u&&x.isHome){if(a()){k.PersonalizationModal._toggleModal();setTimeout(function(){k("#ucm__step-tabs").tabs("select_tab","ucm__step-2")},500)}else{m(x.timeOutCookie,(new Date()).getTime()+x.timeToRefreshModal,x.daysToExpire)}}}};j.prototype.bindEvents=function(){var s=this;s.isValid=false;k.PersonalizationModal.onClose(function(){m(s.timeOutCookie,(new Date()).getTime()+s.timeToRefreshModal,s.daysToExpire)});this.settingsCardsDiv.click(function(t){s.cardOnclick(t);s.submit(true);k("#ucm").modal("close")});this.clientPhoneInpt.on("change keyup blur",function(x){var w=k(this),v=w.parent(),u=w.siblings(".error-label");var t=new RegExp(h);if(t.test(w.val())){v.removeClass("error").addClass("valid");s.isValid=true}else{v.removeClass("valid").addClass("error");s.isValid=true}});this.clientPhoneInpt.on("keydown",function(t){if(k.inArray(t.keyCode,[46,8,9,27,13,110,190])!==-1||(t.keyCode==65&&t.ctrlKey===true)||(t.keyCode>=35&&t.keyCode<=39)){}else{if((t.shiftKey||(t.keyCode<48||t.keyCode>57))&&(t.keyCode<96||t.keyCode>105)){t.preventDefault()}}});this.clientPhoneButton.click(function(t){if(!s.isValid){return false}s.clientPhone=s.clientPhoneInpt.val();s.refreshSelectedCards();k("#ucm__step-tabs").tabs("select_tab","ucm__step-2")});this.notClient.click(function(){s.clientPhone=null;s.refreshSelectedCards()})};j.prototype.refreshSelectedCards=function(){var u=this;var t=n(this.cookieSegmentsName);var s=t.segment;this.settingsCards.prop("checked",false);if(s){u.settingsCards.each(function(v,x){var w=k(x);if(s===w.data("segment")){w.prop("checked",true)}})}};j.prototype.forceSettings=function(s,v){var u=this;if(s&&v){m(u.timeOutCookie,(new Date()).getTime()+u.timeToRefreshModal,u.daysToExpire);var t={phone:s?s:g,segment:v,active:true,profile:s?q:c};m(u.cookieSegmentsName,JSON.stringify(t),u.daysToExpire);m(u.cookieUserProfileName,t.profile,u.daysToExpire);m(u.cookieSegmentsSharedName,v,u.daysToExpire);if(t.phone){m(u.cookieUserPhoneName,s,u.daysToExpire)}o.location.reload(true)}else{if(s&&u.isHome){u.clientPhoneInpt.val(userPhone);u.refreshSelectedCards();setTimeout(function(){k("#ucm__step-tabs").tabs("select_tab","ucm__step-2")},500)}else{if(s){m(u.cookieUserPhoneName,s,u.daysToExpire);var w={};w.UserID=u._toB64(s);w.tipoCliente=q;o.dataLayer.push(w)}else{var w={};w.tipoCliente=c;o.dataLayer.push(w)}}}};var b=function(s){this.base=d;this.base(s);this.toggleActiveCheckbox=k("#"+s+"toggleActive");this.clientRadio=k("#"+s+"radiosClient #ucClient");this.clientInp=k("#"+s+"personalizacionPhone #personalizacion_phone");this.notClientRadio=k("#"+s+"radiosClient #ucNotClient")};b.prototype=new d();b.prototype.init=function(){this.checkUserCfg();this.bindEvents()};b.prototype.checkUserCfg=function(){var t=n(this.cookieSegmentsName);var s=t.profile;if(typeof t.active==="undefined"||t.active){this.toggleActiveCheckbox.prop("checked",true)}if(t.phone){this.clientRadio.prop("checked",true);this.clientInp.val(t.phone);this.clientPhone=t.phone}else{if(s&&s===c){this.notClientRadio.prop("checked",true)}}if(t.segment){this.settingsCards.each(function(u,w){var v=k(w);if(t.segment===v.data("segment")){v.prop("checked",true)}})}};b.prototype.bindEvents=function(){var s=this;this.toggleActiveCheckbox.change(function(){s.submit(s.toggleActiveCheckbox.prop("checked"))});this.settingsCardsDiv.click(function(t){s.cardOnclick(t);s.submit(s.toggleActiveCheckbox.prop("checked"))});this.notClientRadio.change(function(){if(s.notClientRadio.prop("checked")){s.clientPhone=null}});this.clientInp.change(function(){s.clientPhone=s.clientInp.val();s.clientRadio.prop("checked",true)})};var p=function(s){this.base=d;this.base(s);this.toggleActiveCheckbox=k("#"+s+"toggleActive");this.menuSettingsWrapperDiv=k(".npmenu.js-npmenu");this.menuSettingsOnDiv=k(".npmenu__settings--on");this.menuSettingsOffDiv=k(".npmenu__settings--off");this.clientTab=k("#"+s+"clientTab");this.notClientTab=k("#"+s+"notclientTab");this.clientPhoneWrapper=k("#"+s+"clientPhoneInpWrapper");this.clientInp=this.clientPhoneWrapper.find("#npmenu-panel__phone")};p.prototype=new d();p.prototype.init=function(){this.checkUserCfg();this.bindEvents()};p.prototype.checkUserCfg=function(){var t=n(this.cookieSegmentsName);var s=i(this.cookieUserProfileName);if(typeof t.active==="undefined"||t.active){this.toggleActiveCheckbox.prop("checked",true);this.menuSettingsOnDiv.css("opacity","1");this.menuSettingsOffDiv.css("opacity","0");this.menuSettingsWrapperDiv.addClass("npmenu__settings--isActive");this.settingsCards.each(function(u,v){k(v).closest(".checkbox__panel").css("opacity","1")})}if(t.phone){this.clientTab.addClass("active");this.notClientTab.removeClass("active");this.clientPhoneWrapper.show();this.clientInp.val(t.phone);this.clientPhone=t.phone}else{if(s&&s===c){this.clientTab.removeClass("active");this.notClientTab.addClass("active");this.clientPhone=null;this.clientPhoneWrapper.hide()}}if(t.segment){this.settingsCards.each(function(u,w){var v=k(w);if(t.segment===v.data("segment")){v.prop("checked",true)}})}};p.prototype.bindEvents=function(){var s=this;this.toggleActiveCheckbox.change(function(){s.submit(s.toggleActiveCheckbox.prop("checked"))});this.settingsCardsDiv.click(function(t){s.cardOnclick(t);if(s.clientTab.hasClass("active")){s.clientPhone=s.clientInp.val()}else{s.clientPhone=null}s.submit(s.toggleActiveCheckbox.prop("checked"))})};function m(t,u,v){var s=new Date();s.setTime(s.getTime()+(v*24*60*60*1000));expires="; expires="+s.toUTCString();r.cookie=t+"="+u+expires+"; path=/"}function n(s){var t=i(s);if(t){return JSON.parse(t)}else{return{}}}function i(t){var v=t+"=";var s=r.cookie.split(";");for(var u=0;u<s.length;u++){var w=s[u];while(w.charAt(0)===" "){w=w.substring(1,w.length)}if(w.indexOf(v)===0){return w.substring(v.length,w.length)}}return null}function a(){if(navigator.cookieEnabled){return true}r.cookie="cookietest=1";var s=r.cookie.indexOf("cookietest=")!=-1;r.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT";return s}})(jQuery,window,document)}catch(e){console.log("Error in client settings js",e)};