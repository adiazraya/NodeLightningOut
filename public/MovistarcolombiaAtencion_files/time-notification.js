var cookieNameTIME;var cookieNameNotification;var cookieExpirationTIME;jQuery(document).ready(function(){if(!("Notification" in window)){console.error("This browser does not support html5 notifications!")}else{Notification.requestPermission().then(function(a){console.info("Permission html5 notifications: "+a);if(a==="granted"){cookieNameTIME=jQuery("[id$='cookieNameTIME']").val();cookieNameNotification=jQuery("[id$='cookieNameNotification']").val();cookieExpirationTIME=jQuery("[id$='cookieExpiration']").val();readSegmentCookie()}})}});function readSegmentCookie(){var a=document.cookie.match("(^|;) ?"+cookieNameTIME+"=([^;]*)(;|$)");var b=a?a[2]:null;var c=readNotificationCookie();getNotificationBySegment(b,c)}function readNotificationCookie(){var a=document.cookie.match("(^|;) ?"+cookieNameNotification+"=([^;]*)(;|$)");var b=a?a[2]:null;return b}function getNotificationBySegment(b,a){jQuery.ajax({url:jQuery("[id$='ajaxGetNotificationBySegmentURL']").val(),type:"get",dataType:"json",data:{usersegment:b,notification:a},cache:false,success:function(e,f,d){if(e!=undefined&&e!=null&&e!=""){for(var c in e.arrNotifications){sendHtml5Notification(e.arrNotifications[c].body,e.arrNotifications[c].title,e.arrNotifications[c].image,e.arrNotifications[c].id,e.arrNotifications[c].click)}}},error:function(c,e,d){console.error("ajaxNotification error!")}})}function sendHtml5Notification(e,b,g,f,a){var d={icon:(g!="")?g:themeDisplay.getPathThemeImages()+"/movistarHtml5Notification.png",body:e,requireInteraction:false};var c=new Notification(b,d);c.onclose=function(h){closeHtml5Notification(f)};c.onclick=function(h){h.preventDefault();if(a!=""){window.open(a,"_blank")}c.close()}}function closeHtml5Notification(a){var b=readNotificationCookie();if(b==null){b=a}else{b+=","+a}createNotificationCookie(cookieNameNotification,b,cookieExpirationTIME)}function createNotificationCookie(a,b,c){if(c){date=new Date();date.setTime(date.getTime()+(c*24*60*60*1000));expires="; expires="+date.toUTCString()}else{expires=""}document.cookie=a+"="+b+expires+";path=/"};